#!/bin/sh

/usr/bin/mysql --user=mmud --password=itsasecret mmud <<END_OF_DATA
#
# create a patch for the new version of the mud
#

create table boards 
(
boardname varchar(20) NOT NULL default 'public',
name varchar(20) NOT NULL default '',
posttime datetime NOT NULL,
message text NOT NULL,
primary key (boardname, name, posttime)
);

alter table tmp_itemtable 
add (containerid int default 0 not null);

alter table itemtable
add (containerid int default 0 not null);

alter table bogus_itemtable
add (containerid int default 0 not null);

alter table olditem
add (containerid int default 0 not null);

alter table respawningitemtable
add (containerid int default 0 not null);

alter table itemtable drop primary key;
alter table itemtable add primary key (id, search, belongsto, room ,
wearing, wielding, containerid);

alter table tmp_itemtable drop primary key;
alter table tmp_itemtable add primary key (id, search, belongsto, room ,
wearing, wielding, containerid);

create table containeditems (id int(7) not null,
/*search = ''*/
/*not necessary because inherited from parent... 
belongsto varchar(20) not null,*/
amount int(7),
/*room int(7) default 0,*/
/*wearing
wielding*/
containedin int(11) not null,
primary key (id, containedin));

/* change primary key to include containerid */

alter table items
add (container int default 0 not null); /* specify weight in units, 0=no
container */


END_OF_DATA

